/*
  File           : WebServicesQuery.cs

  Description    : Wrapper class for Oracle package WEB_SERVICES_QUERY.
                   This code was generated by the PackageGenerator, do not edit.

  Generated with Commandline: WEB_SERVICES_QUERY WebServicesQuery.cs Imi.Wms.WebServices.SyncWS.Interface.OrderPortal 

*/
#define ODP_NET
using System;
using System.Data;
#if ODP_NET
using Oracle.DataAccess.Client;
using Oracle.DataAccess.Types;
#else
using System.Data.OracleClient;
#endif
using Imi.Framework.Job.Data;

namespace Imi.Wms.WebServices.SyncWS.Interface.OrderPortal
{
  public partial class WebServicesQuery
  {
    private IDbConnectionProvider connectionProvider;

    public string _Debug()
    {
      return  "Package        : WEB_SERVICES_QUERY\r\n" +
              "Generated on   : 2008-03-19 17:15:54\r\n" +
              "Generated by   : SWG\\olla@IMIPC1091\r\n" +
              "Generated in   : C:\\TEMP\\3plportal\\c3plInterface\\Wms.WebServices.SyncWS.Interface.OrderPortal\\Package\r\n";
    }

    public WebServicesQuery(IDbConnectionProvider connectionProvider)
    {
      this.connectionProvider = connectionProvider;
    }

    private IDbCommand sp_Getcustomerorderheadinfo;
    private IDbCommand sp_Getcustomerorderinfo;
    private IDbCommand sp_Getcustomerorderlinerange;
    private IDbCommand currentCommand;
    private object syncLock = new object();

    // ----------------------------------------------------------------------------

    private void CreateSP_Getcustomerorderheadinfo()
    {
      IDbDataParameter p;
      OracleParameter  oP;

      sp_Getcustomerorderheadinfo = connectionProvider.GetConnection().CreateCommand();
      sp_Getcustomerorderheadinfo.CommandText = "WEB_SERVICES_QUERY.GETCUSTOMERORDERHEADINFO";
      sp_Getcustomerorderheadinfo.CommandType = System.Data.CommandType.StoredProcedure;
#if ODP_NET
      ((OracleCommand)sp_Getcustomerorderheadinfo).BindByName = true;
#endif

      p = sp_Getcustomerorderheadinfo.CreateParameter();
      p.ParameterName = "CLIENTIDENTITY_I";
      p.DbType = DbType.String;
      p.Size = 17;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderheadinfo.Parameters.Add( p );

      p = sp_Getcustomerorderheadinfo.CreateParameter();
      p.ParameterName = "ORDERNUMBER_I";
      p.DbType = DbType.String;
      p.Size = 35;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderheadinfo.Parameters.Add( p );

      p = sp_Getcustomerorderheadinfo.CreateParameter();
      p.ParameterName = "ORDERSEQUENCE_I";
      p.DbType = DbType.Decimal;
      p.Precision = 3;
      p.Scale     = 0;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderheadinfo.Parameters.Add( p );

      p = sp_Getcustomerorderheadinfo.CreateParameter();
      p.ParameterName = "LANGUAGEID_I";
      p.DbType = DbType.String;
      p.Size = 3;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderheadinfo.Parameters.Add( p );

      oP = sp_Getcustomerorderheadinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERORDER_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderheadinfo.Parameters.Add( oP );

      oP = sp_Getcustomerorderheadinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERWORKORDER_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderheadinfo.Parameters.Add( oP );

      oP = sp_Getcustomerorderheadinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "DEPARTURE_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderheadinfo.Parameters.Add( oP );

      oP = sp_Getcustomerorderheadinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "ORDERQUANTITIES_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderheadinfo.Parameters.Add( oP );
    }

    private void CreateSP_Getcustomerorderinfo()
    {
      IDbDataParameter p;
      OracleParameter  oP;

      sp_Getcustomerorderinfo = connectionProvider.GetConnection().CreateCommand();
      sp_Getcustomerorderinfo.CommandText = "WEB_SERVICES_QUERY.GETCUSTOMERORDERINFO";
      sp_Getcustomerorderinfo.CommandType = System.Data.CommandType.StoredProcedure;
#if ODP_NET
      ((OracleCommand)sp_Getcustomerorderinfo).BindByName = true;
#endif

      p = sp_Getcustomerorderinfo.CreateParameter();
      p.ParameterName = "CLIENTIDENTITY_I";
      p.DbType = DbType.String;
      p.Size = 17;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderinfo.Parameters.Add( p );

      p = sp_Getcustomerorderinfo.CreateParameter();
      p.ParameterName = "ORDERNUMBER_I";
      p.DbType = DbType.String;
      p.Size = 35;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderinfo.Parameters.Add( p );

      p = sp_Getcustomerorderinfo.CreateParameter();
      p.ParameterName = "ORDERSEQUENCE_I";
      p.DbType = DbType.Decimal;
      p.Precision = 3;
      p.Scale     = 0;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderinfo.Parameters.Add( p );

      p = sp_Getcustomerorderinfo.CreateParameter();
      p.ParameterName = "LANGUAGEID_I";
      p.DbType = DbType.String;
      p.Size = 3;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderinfo.Parameters.Add( p );

      oP = sp_Getcustomerorderinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERORDER_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderinfo.Parameters.Add( oP );

      oP = sp_Getcustomerorderinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERWORKORDER_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderinfo.Parameters.Add( oP );

      oP = sp_Getcustomerorderinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "DEPARTURE_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderinfo.Parameters.Add( oP );

      oP = sp_Getcustomerorderinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "ORDERQUANTITIES_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderinfo.Parameters.Add( oP );

      oP = sp_Getcustomerorderinfo.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERORDERROW_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderinfo.Parameters.Add( oP );
    }

    private void CreateSP_Getcustomerorderlinerange()
    {
      IDbDataParameter p;
      OracleParameter  oP;

      sp_Getcustomerorderlinerange = connectionProvider.GetConnection().CreateCommand();
      sp_Getcustomerorderlinerange.CommandText = "WEB_SERVICES_QUERY.GETCUSTOMERORDERLINERANGE";
      sp_Getcustomerorderlinerange.CommandType = System.Data.CommandType.StoredProcedure;
#if ODP_NET
      ((OracleCommand)sp_Getcustomerorderlinerange).BindByName = true;
#endif

      p = sp_Getcustomerorderlinerange.CreateParameter();
      p.ParameterName = "CLIENTIDENTITY_I";
      p.DbType = DbType.String;
      p.Size = 17;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderlinerange.Parameters.Add( p );

      p = sp_Getcustomerorderlinerange.CreateParameter();
      p.ParameterName = "ORDERNUMBER_I";
      p.DbType = DbType.String;
      p.Size = 35;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderlinerange.Parameters.Add( p );

      p = sp_Getcustomerorderlinerange.CreateParameter();
      p.ParameterName = "ORDERSEQUENCE_I";
      p.DbType = DbType.Decimal;
      p.Precision = 3;
      p.Scale     = 0;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderlinerange.Parameters.Add( p );

      p = sp_Getcustomerorderlinerange.CreateParameter();
      p.ParameterName = "LANGUAGEID_I";
      p.DbType = DbType.String;
      p.Size = 3;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderlinerange.Parameters.Add( p );

      p = sp_Getcustomerorderlinerange.CreateParameter();
      p.ParameterName = "FIRSTLINEPOSITION_I";
      p.DbType = DbType.Decimal;
      p.Precision = 5;
      p.Scale     = 0;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderlinerange.Parameters.Add( p );

      p = sp_Getcustomerorderlinerange.CreateParameter();
      p.ParameterName = "LASTLINEPOSITION_I";
      p.DbType = DbType.Decimal;
      p.Precision = 5;
      p.Scale     = 0;
      p.Direction = ParameterDirection.Input;
      sp_Getcustomerorderlinerange.Parameters.Add( p );

      oP = sp_Getcustomerorderlinerange.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERORDER_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderlinerange.Parameters.Add( oP );

      oP = sp_Getcustomerorderlinerange.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERWORKORDER_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderlinerange.Parameters.Add( oP );

      oP = sp_Getcustomerorderlinerange.CreateParameter() as OracleParameter;
      oP.ParameterName = "DEPARTURE_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderlinerange.Parameters.Add( oP );

      oP = sp_Getcustomerorderlinerange.CreateParameter() as OracleParameter;
      oP.ParameterName = "ORDERQUANTITIES_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderlinerange.Parameters.Add( oP );

      oP = sp_Getcustomerorderlinerange.CreateParameter() as OracleParameter;
      oP.ParameterName = "CUSTOMERORDERROW_CUR_O";
#if ODP_NET
      oP.OracleDbType = OracleDbType.RefCursor;
#else
      oP.OracleType = OracleType.Cursor;
#endif
      oP.Direction = ParameterDirection.Output;
      sp_Getcustomerorderlinerange.Parameters.Add( oP );
    }

    // ----------------------------------------------------------------------------

    public void Getcustomerorderheadinfo(string                  CLIENTIDENTITY_I, 
                                         string                  ORDERNUMBER_I, 
                                         Nullable<int>           ORDERSEQUENCE_I, 
                                         string                  LANGUAGEID_I, 
                                         out IDataReader         CUSTOMERORDER_CUR_O, 
                                         out IDataReader         CUSTOMERWORKORDER_CUR_O, 
                                         out IDataReader         DEPARTURE_CUR_O, 
                                         out IDataReader         ORDERQUANTITIES_CUR_O)
    {
      if ( sp_Getcustomerorderheadinfo == null )
        CreateSP_Getcustomerorderheadinfo();

      sp_Getcustomerorderheadinfo.Transaction = connectionProvider.CurrentTransaction;

      lock (syncLock)
      {
          currentCommand = sp_Getcustomerorderheadinfo;
      }
      // Set In Parameters

      if ( String.IsNullOrEmpty(CLIENTIDENTITY_I) )
        (sp_Getcustomerorderheadinfo.Parameters["CLIENTIDENTITY_I"] as IDbDataParameter).Value = DBNull.Value;
      else
        (sp_Getcustomerorderheadinfo.Parameters["CLIENTIDENTITY_I"] as IDbDataParameter).Value = CLIENTIDENTITY_I;

      if ( String.IsNullOrEmpty(ORDERNUMBER_I) )
        (sp_Getcustomerorderheadinfo.Parameters["ORDERNUMBER_I"] as IDbDataParameter).Value    = DBNull.Value;
      else
        (sp_Getcustomerorderheadinfo.Parameters["ORDERNUMBER_I"] as IDbDataParameter).Value    = ORDERNUMBER_I;

      if ( ORDERSEQUENCE_I == null )
        (sp_Getcustomerorderheadinfo.Parameters["ORDERSEQUENCE_I"] as IDbDataParameter).Value  = DBNull.Value;
      else
        (sp_Getcustomerorderheadinfo.Parameters["ORDERSEQUENCE_I"] as IDbDataParameter).Value  = ORDERSEQUENCE_I;

      if ( String.IsNullOrEmpty(LANGUAGEID_I) )
        (sp_Getcustomerorderheadinfo.Parameters["LANGUAGEID_I"] as IDbDataParameter).Value     = DBNull.Value;
      else
        (sp_Getcustomerorderheadinfo.Parameters["LANGUAGEID_I"] as IDbDataParameter).Value     = LANGUAGEID_I;

      // Execute stored procedure

      sp_Getcustomerorderheadinfo.Prepare();
      sp_Getcustomerorderheadinfo.ExecuteNonQuery();

      // Set Out Parameters

#if ODP_NET
      CUSTOMERORDER_CUR_O = (IDataReader)((sp_Getcustomerorderheadinfo.Parameters["CUSTOMERORDER_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERORDER_CUR_O = (IDataReader)(sp_Getcustomerorderheadinfo.Parameters["CUSTOMERORDER_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      CUSTOMERWORKORDER_CUR_O = (IDataReader)((sp_Getcustomerorderheadinfo.Parameters["CUSTOMERWORKORDER_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERWORKORDER_CUR_O = (IDataReader)(sp_Getcustomerorderheadinfo.Parameters["CUSTOMERWORKORDER_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      DEPARTURE_CUR_O = (IDataReader)((sp_Getcustomerorderheadinfo.Parameters["DEPARTURE_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      DEPARTURE_CUR_O = (IDataReader)(sp_Getcustomerorderheadinfo.Parameters["DEPARTURE_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      ORDERQUANTITIES_CUR_O = (IDataReader)((sp_Getcustomerorderheadinfo.Parameters["ORDERQUANTITIES_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      ORDERQUANTITIES_CUR_O = (IDataReader)(sp_Getcustomerorderheadinfo.Parameters["ORDERQUANTITIES_CUR_O"] as IDbDataParameter).Value;
#endif

    }

    public void Getcustomerorderinfo(string                  CLIENTIDENTITY_I, 
                                     string                  ORDERNUMBER_I, 
                                     Nullable<int>           ORDERSEQUENCE_I, 
                                     string                  LANGUAGEID_I, 
                                     out IDataReader         CUSTOMERORDER_CUR_O, 
                                     out IDataReader         CUSTOMERWORKORDER_CUR_O, 
                                     out IDataReader         DEPARTURE_CUR_O, 
                                     out IDataReader         ORDERQUANTITIES_CUR_O, 
                                     out IDataReader         CUSTOMERORDERROW_CUR_O)
    {
      if ( sp_Getcustomerorderinfo == null )
        CreateSP_Getcustomerorderinfo();

      sp_Getcustomerorderinfo.Transaction = connectionProvider.CurrentTransaction;

      lock (syncLock)
      {
          currentCommand = sp_Getcustomerorderinfo;
      }
      // Set In Parameters

      if ( String.IsNullOrEmpty(CLIENTIDENTITY_I) )
        (sp_Getcustomerorderinfo.Parameters["CLIENTIDENTITY_I"] as IDbDataParameter).Value = DBNull.Value;
      else
        (sp_Getcustomerorderinfo.Parameters["CLIENTIDENTITY_I"] as IDbDataParameter).Value = CLIENTIDENTITY_I;

      if ( String.IsNullOrEmpty(ORDERNUMBER_I) )
        (sp_Getcustomerorderinfo.Parameters["ORDERNUMBER_I"] as IDbDataParameter).Value    = DBNull.Value;
      else
        (sp_Getcustomerorderinfo.Parameters["ORDERNUMBER_I"] as IDbDataParameter).Value    = ORDERNUMBER_I;

      if ( ORDERSEQUENCE_I == null )
        (sp_Getcustomerorderinfo.Parameters["ORDERSEQUENCE_I"] as IDbDataParameter).Value  = DBNull.Value;
      else
        (sp_Getcustomerorderinfo.Parameters["ORDERSEQUENCE_I"] as IDbDataParameter).Value  = ORDERSEQUENCE_I;

      if ( String.IsNullOrEmpty(LANGUAGEID_I) )
        (sp_Getcustomerorderinfo.Parameters["LANGUAGEID_I"] as IDbDataParameter).Value     = DBNull.Value;
      else
        (sp_Getcustomerorderinfo.Parameters["LANGUAGEID_I"] as IDbDataParameter).Value     = LANGUAGEID_I;

      // Execute stored procedure

      sp_Getcustomerorderinfo.Prepare();
      sp_Getcustomerorderinfo.ExecuteNonQuery();

      // Set Out Parameters

#if ODP_NET
      CUSTOMERORDER_CUR_O = (IDataReader)((sp_Getcustomerorderinfo.Parameters["CUSTOMERORDER_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERORDER_CUR_O = (IDataReader)(sp_Getcustomerorderinfo.Parameters["CUSTOMERORDER_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      CUSTOMERWORKORDER_CUR_O = (IDataReader)((sp_Getcustomerorderinfo.Parameters["CUSTOMERWORKORDER_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERWORKORDER_CUR_O = (IDataReader)(sp_Getcustomerorderinfo.Parameters["CUSTOMERWORKORDER_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      DEPARTURE_CUR_O = (IDataReader)((sp_Getcustomerorderinfo.Parameters["DEPARTURE_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      DEPARTURE_CUR_O = (IDataReader)(sp_Getcustomerorderinfo.Parameters["DEPARTURE_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      ORDERQUANTITIES_CUR_O = (IDataReader)((sp_Getcustomerorderinfo.Parameters["ORDERQUANTITIES_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      ORDERQUANTITIES_CUR_O = (IDataReader)(sp_Getcustomerorderinfo.Parameters["ORDERQUANTITIES_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      CUSTOMERORDERROW_CUR_O = (IDataReader)((sp_Getcustomerorderinfo.Parameters["CUSTOMERORDERROW_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERORDERROW_CUR_O = (IDataReader)(sp_Getcustomerorderinfo.Parameters["CUSTOMERORDERROW_CUR_O"] as IDbDataParameter).Value;
#endif

    }

    public void Getcustomerorderlinerange(string                  CLIENTIDENTITY_I, 
                                          string                  ORDERNUMBER_I, 
                                          Nullable<int>           ORDERSEQUENCE_I, 
                                          string                  LANGUAGEID_I, 
                                          Nullable<int>           FIRSTLINEPOSITION_I, 
                                          Nullable<int>           LASTLINEPOSITION_I, 
                                          out IDataReader         CUSTOMERORDER_CUR_O, 
                                          out IDataReader         CUSTOMERWORKORDER_CUR_O, 
                                          out IDataReader         DEPARTURE_CUR_O, 
                                          out IDataReader         ORDERQUANTITIES_CUR_O, 
                                          out IDataReader         CUSTOMERORDERROW_CUR_O)
    {
      if ( sp_Getcustomerorderlinerange == null )
        CreateSP_Getcustomerorderlinerange();

      sp_Getcustomerorderlinerange.Transaction = connectionProvider.CurrentTransaction;

      lock (syncLock)
      {
          currentCommand = sp_Getcustomerorderlinerange;
      }
      // Set In Parameters

      if ( String.IsNullOrEmpty(CLIENTIDENTITY_I) )
        (sp_Getcustomerorderlinerange.Parameters["CLIENTIDENTITY_I"] as IDbDataParameter).Value    = DBNull.Value;
      else
        (sp_Getcustomerorderlinerange.Parameters["CLIENTIDENTITY_I"] as IDbDataParameter).Value    = CLIENTIDENTITY_I;

      if ( String.IsNullOrEmpty(ORDERNUMBER_I) )
        (sp_Getcustomerorderlinerange.Parameters["ORDERNUMBER_I"] as IDbDataParameter).Value       = DBNull.Value;
      else
        (sp_Getcustomerorderlinerange.Parameters["ORDERNUMBER_I"] as IDbDataParameter).Value       = ORDERNUMBER_I;

      if ( ORDERSEQUENCE_I == null )
        (sp_Getcustomerorderlinerange.Parameters["ORDERSEQUENCE_I"] as IDbDataParameter).Value     = DBNull.Value;
      else
        (sp_Getcustomerorderlinerange.Parameters["ORDERSEQUENCE_I"] as IDbDataParameter).Value     = ORDERSEQUENCE_I;

      if ( String.IsNullOrEmpty(LANGUAGEID_I) )
        (sp_Getcustomerorderlinerange.Parameters["LANGUAGEID_I"] as IDbDataParameter).Value        = DBNull.Value;
      else
        (sp_Getcustomerorderlinerange.Parameters["LANGUAGEID_I"] as IDbDataParameter).Value        = LANGUAGEID_I;

      if ( FIRSTLINEPOSITION_I == null )
        (sp_Getcustomerorderlinerange.Parameters["FIRSTLINEPOSITION_I"] as IDbDataParameter).Value = DBNull.Value;
      else
        (sp_Getcustomerorderlinerange.Parameters["FIRSTLINEPOSITION_I"] as IDbDataParameter).Value = FIRSTLINEPOSITION_I;

      if ( LASTLINEPOSITION_I == null )
        (sp_Getcustomerorderlinerange.Parameters["LASTLINEPOSITION_I"] as IDbDataParameter).Value  = DBNull.Value;
      else
        (sp_Getcustomerorderlinerange.Parameters["LASTLINEPOSITION_I"] as IDbDataParameter).Value  = LASTLINEPOSITION_I;

      // Execute stored procedure

      sp_Getcustomerorderlinerange.Prepare();
      sp_Getcustomerorderlinerange.ExecuteNonQuery();

      // Set Out Parameters

#if ODP_NET
      CUSTOMERORDER_CUR_O = (IDataReader)((sp_Getcustomerorderlinerange.Parameters["CUSTOMERORDER_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERORDER_CUR_O = (IDataReader)(sp_Getcustomerorderlinerange.Parameters["CUSTOMERORDER_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      CUSTOMERWORKORDER_CUR_O = (IDataReader)((sp_Getcustomerorderlinerange.Parameters["CUSTOMERWORKORDER_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERWORKORDER_CUR_O = (IDataReader)(sp_Getcustomerorderlinerange.Parameters["CUSTOMERWORKORDER_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      DEPARTURE_CUR_O = (IDataReader)((sp_Getcustomerorderlinerange.Parameters["DEPARTURE_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      DEPARTURE_CUR_O = (IDataReader)(sp_Getcustomerorderlinerange.Parameters["DEPARTURE_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      ORDERQUANTITIES_CUR_O = (IDataReader)((sp_Getcustomerorderlinerange.Parameters["ORDERQUANTITIES_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      ORDERQUANTITIES_CUR_O = (IDataReader)(sp_Getcustomerorderlinerange.Parameters["ORDERQUANTITIES_CUR_O"] as IDbDataParameter).Value;
#endif


#if ODP_NET
      CUSTOMERORDERROW_CUR_O = (IDataReader)((sp_Getcustomerorderlinerange.Parameters["CUSTOMERORDERROW_CUR_O"] as IDbDataParameter).Value as OracleRefCursor).GetDataReader();
#else
      CUSTOMERORDERROW_CUR_O = (IDataReader)(sp_Getcustomerorderlinerange.Parameters["CUSTOMERORDERROW_CUR_O"] as IDbDataParameter).Value;
#endif

    }

    public void Cancel()
    {
      lock (syncLock)
      {
        if (currentCommand != null)
        {
          if (currentCommand.Connection != null)
          {
            if (currentCommand.Connection.State != ConnectionState.Closed)
            {
              currentCommand.Cancel();
            }
          }
        }
      }
    }
  }
}
